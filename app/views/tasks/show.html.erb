<div class="task-details">
  <ul class="nav nav-tabs task-detail-tab">
    <li class="active"><a href="#general" data-toggle="tab">General</a></li>
    <li><a href="#relation" data-toggle="tab">Relationship</a></li>
    <li><a href="#history" data-toggle="tab">History</a></li>
  </ul>

  <!-- Tab panes -->
  <div class="tab-content">
    <div class="tab-pane active task-details-content-left pull-left" id="general">
      <div class="task-title">
        <label class="label label-primary"> Task </label>
        <div class="task-name inline"> <%= @task.title %> </div>
      </div>
      <div class="task-description" contenteditable>
        <%= @task.description %>
      </div>
      <div class="add-attachment">

      </div>
      <div id="comments">
        <ul class="comments-list reset-padding">

          <% @comments.each do |comment| %>
              <li>
                <%= render :partial => 'shared/comments_item', :locals => {:comment => comment} %>
                <div class="comments-reply" style="visibility: hidden">
                  <%=   link_to 'reply', 'javascript:void(0);', class: :reply , parent: comment.id %>
                </div>
              </li>
          <% end %>

        </ul>
      </div>
      <div id="write-comments" style="margin-bottom: 10px;">
        <textarea style="" class="form-control jqte-test"></textarea>
      </div>
      <div>
        <button type="button" id="btncomment" class="btn btn-primary">Save</button>
      </div>

    </div>
    <div class="tab-pane task-details-content-left pull-left" id="relation">...</div>
    <div class="tab-pane task-details-content-left pull-left" id="history">...</div>
    <div class="pull-right task-details-content-right">
      <div class="panel panel-default progress-info">
        <div class="panel-heading">
         <h3  class="panel-title"> Progress</h3>
        </div>
        <div class="progressbar" style="margin-top: 10px;">
        </div>
        <div class="panel-body">
          <li>
            <label class="info-label"> Effort </label>
            <span class="info-txt"><%= @task.effort %> h </span>
          </li>
          <li>
            <label class="info-label"> Spend </label>
            <span class="info-txt"><%= @task.spend %> h </span>
          </li>
          <li>
            <label class="info-label"> Remaining </label>
            <span class="info-txt"><%= (@task.effort - @task.spend) %> h </span>
          </li>
        </div>
      </div>

      <div class="panel panel-success task-info">
        <div class="panel-heading">
          <h3 class="panel-title">Information</h3>
        </div>
        <div class="panel-body">
        <ul>
          <li>
            <label class="info-label"> Owner </label>
            <span class="info-txt"><%= current_user.name %> </span>
          </li>
          <li>
             <label class="info-label"> Create date</label>
             <span class="info-txt"><%= @task.created_at %> </span>
          </li>
          <li>
            <label class="info-label"> End date</label>
            <span class="info-txt"><%= @task.end_date %> </span>
          </li>
          <li>
            <label class="info-label"> Priority </label>
            <span class="info-txt">
              <%= image_tag("task_#{@task.priority.downcase}.png", :title => 'Priority') %>
            </span>
          </li>
          <li>
            <label> Assigned People</label>
          </li>
        </ul>
        </div>
      </div>
    </div>
    <div class="clearfix"></div>
  </div>
  <div class="clearfix"></div>
</div>

<script type="text/javascript">
    $(document).ready(function(){
        $('.jqte-test').jqte();

        $( ".progressbar" ).progressbar({
            value: 50
        });
    });
    $('#btncomment').click(function () {

        comment = $("textarea").val();
        $.ajax({
            type: 'POST',
            url: "<%= task_comments_path(@task.id) %>",
            dataType: 'script',
            data: { comment: comment},
            success: function (res) {

            },
            error: function (e) {

            }
        });
    });
    $(".comments-list li").mouseover(function(){

        $(this).find(".comments-reply").css('visibility','visible');

    });

    $(".comments-list li").mouseout(function(){

        $(".comments-reply").css('visibility','hidden');

    });

        $(".reply").click(function(){
            parent =  $(this).attr("parent");
            $(".write-reply").remove();
            $(this).before("<%= escape_javascript( get_reply_div )%>");
            $(".btn").click(function(){
                reply =$(".reply_input").val();
                alert(reply);
                $.ajax({
                    type: 'POST',
                    url: "<%= task_comments_path(@task.id) %>",
                    dataType: 'script',
                    data: { comment: reply, parent:  parent},
                    success: function (res) {

                    },
                    error: function (e) {

                    }
                });
            })
        });

</script>